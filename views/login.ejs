<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>登录</title>
</head>
<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="/stylesheets/common.css">
<style>
    .form-box{
        width: 50%;
        margin: 0 auto;
    }
</style>
<body>
    <%- include("./header.ejs") %>
	<div class="container">
		<h3 class="text-center">我是登录页</h3>
		<div class="panel panel-primary form-box">
			<div class="panel-heading">
				登录
			</div>
			<div class="panel-body">
				<form id="my_form">
					<div class="form-group">
                        <label for="">用户名：</label>
                        <input id="username" type="text" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="">密码：</label>
                        <input id="password" type="password" class="form-control">
                    </div>
                   
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">提交</button>
                        <button type="reset" class="btn btn-default">重置</button>
                        <a href="/users/regi" class="btn btn-info">注册</a>
                        <a href="/" class="btn btn-info">返回首页</a>
                    </div>
				</form>
			</div>
		</div>
	</div>
	
</body>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src='https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js'></script>
    <script src='/javascripts/jquery.cookie.js'></script>
    <script src='/javascripts/test.js'></script>
    <script src='/javascripts/add.js'></script>
    <script>
        
        $('#my_form').submit(function(e){
            e.preventDefault()
            loginFunc()
        })

        var loginFunc = function(){
            $.ajax({
               url:"/users/login.req",
               type:'get',
               data:{
                   usn:$("#username").val(),
                   pwd:$("#password").val()
               }
            })
            .then(function(res){
                // console.log(res)
                // console.log(res)
                switch(res){
                    case '1':alert('登陆失败'); break;
                    default:
                        alert('登录成功')
                        // 设置cookie
                        handler(res)

                }
            },function(xhr,err){
                console.log(err)
            })
        }
    </script>
</html>